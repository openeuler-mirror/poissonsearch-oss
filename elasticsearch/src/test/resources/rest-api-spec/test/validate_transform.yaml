---
"Test valid transform":
  - do:
      xpack.ml.validate_transform:
        body:  >
          {
            "transform":"concat",
            "inputs": [ "one", "two" ],
            "outputs": [ "oneplustwo" ]
          }
  - match: { acknowledged: true }

---
"Test invalid transform":
  - do:
      catch: /Transform type concat expected \[2‥\+∞\) input\(s\), got 1/
      xpack.ml.validate_transform:
        body:  >
          {
            "transform":"concat",
            "inputs": [ "justone" ],
            "outputs": [ "stilljustone" ]
          }
---
"Test valid transforms":
  - do:
      xpack.ml.validate_transforms:
        body:  >
          {
            "transforms": [
              {
                "transform":"concat",
                "inputs": [ "one", "two" ],
                "outputs": [ "oneplustwo" ]
              },
              {
                "transform":"domain_split",
                "inputs": [ "domain" ],
                "outputs": [ "sub_domain", "highest_registered_domain" ]
              }
            ]
          }
  - match: { acknowledged: true }
---
"Test invalid transforms":
  - do:
      catch: /Transform type concat with inputs \[one, two\] has a circular dependency/
      xpack.ml.validate_transforms:
        body:  >
          {
            "transforms": [
              {
                "transform":"concat",
                "inputs": [ "one", "two" ],
                "outputs": [ "three" ]
              },
              {
                "transform":"concat",
                "inputs": [ "two", "three" ],
                "outputs": [ "one" ]
              }
            ]
          }

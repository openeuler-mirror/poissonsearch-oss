---
"Test watcher is protected by shield":
  - do:
    headers: {es-shield-runas-user: powerless_user}
    catch: forbidden
    watcher.info: {}
  # there seems to be a bug in the yaml parser we use, where a single element list
  # has the END_LIST token skipped...so here we just rerun the same request without
  # the impersonation to show it works
  - do:
    watcher.info: {}
  - is_true: version.build_hash
